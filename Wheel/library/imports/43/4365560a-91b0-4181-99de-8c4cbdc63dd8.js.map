{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        spinBtn: {\n            default: null,      // The default value will be used only when the component attachin                    // to a node for the first time\n            type:cc.Button,     // optional, default is typeof default\n            visible: true,      // optional, default is true\n            displayName: 'SpinBtn', // optional\n        },\n        wheelSp:{\n            default:null,\n            type:cc.Sprite\n        },\n        maxSpeed:{\n            default:3,\n            type:cc.Float,\n            max:10,\n            min:2\n        },\n        duration:{\n            default:3,\n            type:cc.Float,\n            max:5,\n            min:1\n        },\n        acc:{\n            default:0.1,\n            type:cc.Float,\n            max:1,\n            min:0.01\n        },\n        targetID:{\n            default:0,\n            type:cc.Integer,\n            max:17,\n            min:0\n        },\n        effectAudio:{\n            default:null,\n            url:cc.AudioClip\n        }\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        cc.log(\"....onload\");\n        this.wheelState = 0;    \n        this.curSpeed = 0;\n        this.spinTime = 0;                   //减速前旋转时间\n        this.gearNum = 18;                   //齿轮数量\n        this.defaultAngle = 360/18/2;        //默认角度\n        this.gearAngle = 360/this.gearNum;   //每个齿轮的角度\n        this.effectFlag = 0;                 //用于音效播放控制\n        this.finalAngle = 360-this.targetID*this.gearAngle + this.defaultAngle;   //最终结果指定的角度\n        this.wheelSp.node.rotation = this.defaultAngle;\n\n        this.spinBtn.node.on(cc.Node.EventType.TOUCH_END,function(event)\n        {\n            cc.log(\"begin spin\");\n            if(this.wheelState != 0)\n            {\n                 return;\n            }\n            this.decAngle = 2*360;  // 减速旋转两圈\n            this.wheelState = 1;\n            this.curSpeed = 0;\n            this.spinTime = 0;\n        }.bind(this));\n    },\n\n    start:function()\n    {\n        cc.log('....start');\n    },\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        if(this.wheelState == 0)\n        {\n            return;\n        }\n        cc.log('......state=%d',this.wheelState);\n       \n        this.effectFlag += this.curSpeed;\n        if(this.effectFlag >= this.gearAngle)\n        {\n            cc.audioEngine.playEffect(this.effectAudio,false);\n            this.effectFlag = 0;\n        }\n        if(this.wheelState == 1)\n        {\n            cc.log('....开始旋转,speed:' + this.curSpeed);\n            this.spinTime += dt;\n            this.wheelSp.node.rotation = this.wheelSp.node.rotation + this.curSpeed;\n            if(this.curSpeed <= this.maxSpeed)\n            {\n                this.curSpeed += this.acc;\n            }\n            else\n            {\n                if(this.spinTime<this.duration)\n                {\n                    return;\n                }\n                cc.log('....开始减速');\n                //设置目标角度\n                this.wheelSp.node.rotation = this.defaultAngle;\n                this.wheelState = 2;\n            }\n        }\n        else if(this.wheelState == 2)\n        {\n            cc.log('......减速');\n            \n            var curRo = this.wheelSp.node.rotation;\n            var spd = (this.finalAngle - curRo) * 0.02;\n            var finRo = this.finalAngle - curRo;\n            if(spd > this.maxSpeed)\n            {\n                spd = this.maxSpeed;\n            }\n            curRo += spd;\n            this.wheelSp.node.rotation = curRo;\n            if(spd<=0.1)\n            {\n                this.wheelSp.node.rotation = this.finalAngle;\n                this.wheelState = 0;\n            }\n            // this.curSpeed = this.maxSpeed*(this.decAngle/(2*360)) + 0.3; \n            // this.decAngle -= this.curSpeed;\n            // this.wheelSp.node.rotation = this.wheelSp.node.rotation + this.curSpeed;\n\n            // if(this.curSpeed <= 0.01 || this.decAngle<=0)\n            // {  \n            //     cc.log('....停止');\n            //     this.wheelState = 0;\n            //     this.wheelSp.node.rotation = this.finalAngle;\n            //     cc.log('....rotation:'+ this.wheelSp.node.rotation);\n            // }\n        }\n    },\n});\n"
  ]
}