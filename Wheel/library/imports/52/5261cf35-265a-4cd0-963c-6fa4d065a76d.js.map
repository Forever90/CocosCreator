{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        spinBtn: {\n            default: null,      // The default value will be used only when the component attachin                    // to a node for the first time\n            type:cc.Button,     // optional, default is typeof default\n            visible: true,      // optional, default is true\n            displayName: 'SpinBtn', // optional\n        },\n        wheelSp:{\n            default:null,\n            type:cc.Sprite\n        },\n        maxSpeed:{\n            default:3,\n            type:cc.Float,\n            max:10,\n            min:2,\n        },\n        duration:{\n            default:3,\n            type:cc.Float,\n            max:5,\n            min:1,\n            tooltip:\"减速前旋转时间\"\n        },\n        acc:{\n            default:0.1,\n            type:cc.Float,\n            max:0.2,\n            min:0.01,\n            tooltip:\"加速度\"\n        },\n        targetID:{\n            default:0,\n            type:cc.Integer,\n            max:17,\n            min:0,\n            tooltip:\"指定结束时的齿轮\"\n        },\n        springback:{\n            default:true,\n            tooltip:\"旋转结束是否回弹\"\n        },\n        effectAudio:{\n            default:null,\n            url:cc.AudioClip\n        }\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        cc.log(\"....onload\");\n        this.wheelState = 0;    \n        this.curSpeed = 0;\n        this.spinTime = 0;                   //减速前旋转时间\n        this.gearNum = 18;\n        this.defaultAngle = 360/18/2;        //修正默认角度\n        this.gearAngle = 360/this.gearNum;   //每个齿轮的角度\n        this.wheelSp.node.rotation = this.defaultAngle;\n        this.finalAngle = 0;                   //最终结果指定的角度\n        this.effectFlag = 0;                 //用于音效播放\n        \n        if(!cc.sys.isBrowser)\n        {\n            cc.loader.loadRes('Sound/game_turntable', function(err,res){if(err){cc.log('...err:'+err);}});\n        }\n        this.spinBtn.node.on(cc.Node.EventType.TOUCH_END,function(event)\n        {\n            cc.log(\"begin spin\");\n            if(this.wheelState !== 0)\n            {\n                 return;\n            }\n            this.decAngle = 2*360;  // 减速旋转两圈\n            this.wheelState = 1;\n            this.curSpeed = 0;\n            this.spinTime = 0;\n            // var act = cc.rotateTo(10, 360*10);\n            // this.wheelSp.node.runAction(act.easing(cc.easeSineInOut()));\n        }.bind(this));\n    },\n\n    start:function()\n    {\n        // cc.log('....start');\n    },\n    \n    caculateFinalAngle:function(targetID)\n    {\n        this.finalAngle = 360-this.targetID*this.gearAngle + this.defaultAngle;\n        if(this.springback)\n        {\n            this.finalAngle += this.gearAngle;\n        }\n    },\n    editBoxDidBegin:function(edit)\n    {\n    },\n    editBoxDidChanged:function(text)\n    {\n    },\n    editBoxDidEndEditing:function(edit)\n    {\n        var res = parseInt(edit.string);\n        if(isNaN(res))\n        {\n            if(cc.sys.isBrowser)\n            {\n                alert('please input a number!');\n            }else cc.log(\".....invalid input\");\n            this.targetID = Math.round(Math.random()*(this.gearNum-1));\n            return;\n        }\n        this.targetID = res;\n    },\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        if(this.wheelState === 0)\n        {\n            return;\n        }\n        // cc.log('......update');\n        // cc.log('......state=%d',this.wheelState);\n       \n        this.effectFlag += this.curSpeed;\n        if(!cc.sys.isBrowser && this.effectFlag >= this.gearAngle)\n        {\n            if(this.audioID)\n            {\n                // cc.audioEngine.pauseEffect(this.audioID);\n            }\n            // this.audioID = cc.audioEngine.playEffect(this.effectAudio,false);\n            this.audioID = cc.audioEngine.playEffect(cc.url.raw('resources/Sound/game_turntable.mp3'));\n            this.effectFlag = 0;\n        }\n        if(this.wheelState == 1)\n        {\n            // cc.log('....加速,speed:' + this.curSpeed);\n            this.spinTime += dt;\n            this.wheelSp.node.rotation = this.wheelSp.node.rotation + this.curSpeed;\n            if(this.curSpeed <= this.maxSpeed)\n            {\n                this.curSpeed += this.acc;\n            }\n            else\n            {\n                if(this.spinTime<this.duration)\n                {\n                    return;\n                }\n                // cc.log('....开始减速');\n                //设置目标角度\n                this.finalAngle = 360-this.targetID*this.gearAngle + this.defaultAngle;\n                this.maxSpeed = this.curSpeed;\n                if(this.springback)\n                {\n                    this.finalAngle += this.gearAngle;\n                }\n                this.wheelSp.node.rotation = this.finalAngle;\n                this.wheelState = 2;\n            }\n        }\n        else if(this.wheelState == 2)\n        {\n            // cc.log('......减速');\n            var curRo = this.wheelSp.node.rotation; //应该等于finalAngle\n            var hadRo = curRo - this.finalAngle;\n            this.curSpeed = this.maxSpeed*((this.decAngle-hadRo)/this.decAngle) + 0.2; \n            this.wheelSp.node.rotation = curRo + this.curSpeed;\n\n            if((this.decAngle-hadRo)<=0)\n            {  \n                // cc.log('....停止');\n                this.wheelState = 0;\n                this.wheelSp.node.rotation = this.finalAngle;\n                if(this.springback)\n                {\n                    //倒转一个齿轮\n                    var act = new cc.rotateBy(0.5, -this.gearAngle);\n                    var seq = cc.sequence(new cc.delayTime(0.3),act,cc.callFunc(this.showRes, this));\n                    this.wheelSp.node.runAction(seq);\n                }\n                else\n                {\n                    this.showRes();\n                }\n            }\n        }\n    },\n    showRes:function()\n    {\n        var Config = require(\"Config\");\n        if(cc.sys.isBrowser)\n        {\n            alert('You have got ' + Config.gearInfo[this.targetID]);\n        }\n        else cc.log(Config.gearInfo[this.targetID]);\n    }\n});\n"
  ]
}